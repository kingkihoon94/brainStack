# pnpm vs Yarn Berry

## ✅ pnpm이란?

**pnpm**은 성능과 디스크 효율성을 개선한 JavaScript 패키지 매니저입니다. 

### 📌 주요 특징
- **content-addressable store**: 
  - 전역 저장소에 패키지를 저장하고, 프로젝트에서는 **하드 링크 또는 심볼릭 링크**로 연결
  - 동일한 패키지를 여러 프로젝트에서 공유 가능
  - 결과적으로 설치 속도는 빨라지고, 디스크 공간 사용량은 줄어듦

- **유령 의존성(Ghost Dependency) 문제 방지**:
  - 직접 명시하지 않은 의존성을 우연히 사용하는 문제를 방지하기 위해, 의존성 트리를 엄격하게 관리

- **Workspace 지원**:
  - 모노레포 환경에서 여러 패키지를 한 번에 관리하기 용이

---

## ✅ Yarn Berry란?

**Yarn Berry**는 Yarn의 2.0 이상 버전으로, **PnP (Plug'n'Play)** 및 **Zero Install** 개념을 도입한 패키지 매니저입니다.

### 📌 주요 특징

- **PnP (Plug'n'Play)**:
  - `node_modules` 폴더를 제거하고 `.pnp.cjs` 파일을 통해 패키지를 직접 참조
  - 의존성 탐색 과정이 더 빠르고, 명시적이며, 결정적

- **Zero Install**:
  - `.yarn/cache`에 zip 형식으로 저장된 패키지를 버전 관리 시스템에 포함
  - 새로운 개발 환경에서도 별도 설치 없이 바로 실행 가능

- **유령 의존성 방지**:
  - `.pnp.cjs`가 모든 의존성 관계를 명시하므로, 직접 명시하지 않은 패키지를 사용할 수 없음

- **Workspace 지원**:
  - 대규모 모노레포를 관리하는 데 유용

---

## ❓ 추가 질문 1: 유령 의존성(Ghost Dependency) 문제란?

### 📌 정의
- 어떤 모듈이 **직접 의존성으로 명시되지 않았지만**, 우연히 **다른 패키지의 의존성**으로 설치되어 있기 때문에 사용하는 현상

### ❗ 문제점
- 실제로는 의존하지 않지만, **실행 시엔 잘 동작** → 나중에 의존성 구조가 바뀌면 에러 발생 가능성 증가

### 💡 해결 방법
- pnpm: 의존성 트리를 엄격하게 관리해, **직접 명시되지 않은 패키지에 접근 불가**
- Yarn Berry: `.pnp.cjs`를 통한 **정적 의존성 매핑**으로 우회 불가

---

## ❗ 추가 질문 2: pnpm과 Yarn Berry의 단점은?

| 항목 | pnpm | Yarn Berry |
|------|------|-------------|
| 생태계 호환성 | 일부 도구는 `node_modules` 전제를 하여 오류 발생 가능성 | `.pnp.cjs` 방식에 적응이 필요하고, 일부 툴과 충돌 가능 |
| 학습 곡선 | 낮음 (npm 사용자에게 익숙함) | 높음 (기존 구조와 달라 적응 필요) |
| 디버깅 | 표준 구조와 달라 경로 추적이 어려울 수 있음 | 패키지 경로가 `.zip` 안에 있어 디버깅이 번거로울 수 있음 |
| 커스텀 설정 | 고급 사용자에게 강력 | `.yarnrc.yml` 문법 학습 필요 |

---

## ✅ 결론

| 항목 | pnpm | Yarn Berry |
|------|------|-------------|
| 성능 | 🚀 빠름 | 🚀 빠름 |
| 디스크 효율 | 👍 높음 | 👍 높음 (zip 관리) |
| 유령 의존성 방지 | ✅ | ✅ |
| 학습 난이도 | 낮음 | 중간~높음 |
| 호환성 | npm과 유사 | 일부 도구와 호환성 이슈 있음 |

👉 모노레포 + 빠른 설치 속도 + 디스크 절약이 필요하다면 **pnpm**  
👉 Zero Install, PnP 기반 개발환경을 지향한다면 **Yarn Berry**
