# React의 Virtual DOM과 Diffing 알고리즘 최적화

## Virtual DOM이란?

Virtual DOM은 React에서 사용되는 핵심 개념으로, 실제 DOM을 JS 객체 형태로 복제한 가벼운 사본입니다.

브라우저의 DOM은 구조적으로 복잡하고, 이를 직접 조작하는 작업은 성능 비용이 큽니다. Virtual DOM은 이를 개선하여 웹 애플리케이션의 성능을 최적화하기 위해 등장했습니다.

## Virtual DOM의 작동 방식

1. **상태 변경**: 컴포넌트의 상태(state)나 props가 변경되면 새로운 Virtual DOM이 생성됩니다.
2. **재조정(Reconciliation)**: 이전 Virtual DOM과 새 Virtual DOM을 비교(diffing)하여 차이점을 계산합니다.
3. **실제 DOM 업데이트**: 변경 사항만 실제 DOM에 반영하여 최소한의 업데이트를 수행합니다.

이 과정을 메모리 상에서 처리하기 때문에 실제 DOM을 직접 조작하는 것보다 훨씬 빠르고 효율적입니다.

## React의 diffing 알고리즘 최적화

트리 구조 비교는 일반적으로 O(n^3)의 복잡도를 가지지만, React는 휴리스틱 기반의 최적화 전략을 사용하여 이를 **O(n)** 수준으로 줄였습니다.

### 휴리스틱 가정

React는 다음 두 가지 가정을 통해 비교 알고리즘을 최적화합니다:

### 1. 서로 다른 타입의 두 요소는 서로 다른 트리를 만들어낸다

* 요소의 타입이 다르면(예: `<div>` → `<span>`) 전체 요소를 포함한 하위 트리를 제거하고 새로 생성합니다.
* 이는 타입이 다른 경우, 대부분 완전히 다른 컴포넌트이므로 효율적인 처리 방식입니다.
* 동일한 타입의 경우에는 속성만 비교하고 변경된 부분만 갱신합니다.

```jsx
// 이전
<div className="before" title="stuff" />

// 이후
<div className="after" title="stuff" />
```

위의 경우에는 `className`만 변경되며, `title`은 유지됩니다.

### 2. key prop을 통해 리스트 항목을 안정적으로 식별

* 같은 레벨의 자식 요소들을 비교할 때, React는 `key` prop을 사용하여 각 요소를 식별합니다.
* 이로 인해 리스트 내에서 항목이 추가/삭제/이동되더라도 불필요한 전체 갱신 없이 필요한 부분만 효율적으로 갱신할 수 있습니다.

## 결론

Virtual DOM과 최적화된 diffing 알고리즘은 React가 높은 렌더링 성능을 유지할 수 있는 핵심 요소입니다. 실제 DOM 조작의 복잡성을 추상화하고, 효율적인 업데이트를 통해 개발자 경험과 사용자 경험 모두를 향상시킵니다.
